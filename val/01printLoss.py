import matplotlib.pyplot as plt 
import numpy as np
import pandas as pd
import matplotlib.ticker as ticker  
plt.rcParams['font.family'] = 'Times New Roman'
fig = plt.figure(figsize=(10, 6)) 
cnn = 'out/model/CNNRE/training_results.csv'
lstm = 'out/model/LSTMRE/training_results.csv'
# e2elstm = 'out/model/E2ELSTM/training_results.csv'
transformer = 'out/model/TransformerRE/training_results.csv'
attentionlstm ='out/model/AtentionLSTMRE/training_results.csv'
SADMRE = 'out/model/LSTMRE/training_results.csv'
transformerlstm = 'out/model/LSTMTransformer/training_results.csv'
cnn = pd.read_csv(cnn,header=None)
lstm = pd.read_csv(lstm,header=None)
# e2elstm = pd.read_csv(e2elstm,header=None)
transformer = pd.read_csv(transformer,header=None)
SADMRE = pd.read_csv(SADMRE,header=None)
transformerlstm = pd.read_csv(transformerlstm,header=None)
attentionlstm = pd.read_csv(attentionlstm,header=None)
# lstmLoss9C = [0.4, 0.5109, 0.5832, 0.59, 0.6032, 0.6212, 0.6342, 0.6389, 0.6418, 0.6537999999999999, 0.6579999999999999, 0.6629, 0.6681999999999999, 0.6777, 0.6811, 0.6862999999999999, 0.6920000000000001, 0.6970000000000001, 0.7084999999999999, 0.706, 0.718, 0.7293999999999999, 0.7281, 0.7356999999999999, 0.7328, 0.7423000000000001, 0.7451000000000001, 0.7495, 0.7532, 0.7458, 0.7448999999999999, 0.7584000000000001, 0.7633, 0.7585, 0.7703, 0.77, 0.7696999999999999, 0.7752, 0.7755, 0.7815000000000001, 0.7822, 0.7863, 0.7883, 0.7883, 0.7927, 0.7983, 0.8019, 0.8045, 0.7996, 0.8034, 0.8145, 0.8134, 0.8190999999999999, 0.8237000000000001, 0.826, 0.8294, 0.8240999999999999, 0.8293, 0.8359000000000001, 0.8384999999999999, 0.841772848188214, 0.8319393898210493, 0.8494929216187784, 0.8476732483363598, 0.8416865924741531, 0.8479849364465497, 0.8519004725982402, 0.8337591180036419, 0.8426558548536986, 0.8437408520460757, 0.8461835411351943, 0.8425501253168088, 0.8532826176307541, 0.8314075802083044, 0.840142186266596, 0.8438323286327865, 0.8485340835424515, 0.8504281678680239, 0.8435498900443276, 0.8378766982917557, 0.8302835454086386, 0.8523908789128434, 0.8395482477158683, 0.836021345904437, 0.837111271022887, 0.8490999566932604, 0.8544419047113915, 0.8315296262080756, 0.8486808377632189, 0.8594142207492415, 0.8429828712426741, 0.8500947824314754, 0.836225388366863, 0.8461997259840963, 0.8436783613105658, 0.8302482039832116, 0.8309204084219378, 0.8397541055353908, 0.845632910752571, 0.8319552315125613]
# lstmLoss9D = [0.69, 0.7556999999999999, 0.7943999999999999, 0.8217, 0.8545999999999999, 0.8545, 0.8541, 0.8562000000000001, 0.8573999999999999, 0.8572, 0.8581, 0.8584999999999999, 0.8586, 0.8639, 0.8599, 0.8634000000000001, 0.8632, 0.8626, 0.8644, 0.8675, 0.8683, 0.8672, 0.8686, 0.8695999999999999, 0.8709, 0.872, 0.8737999999999999, 0.8756999999999999, 0.8778, 0.8781, 0.8806999999999999, 0.8813, 0.8845000000000001, 0.8845999999999999, 0.8858, 0.8851, 0.8885, 0.892, 0.8918, 0.8936, 0.8967, 0.8961, 0.9011, 0.9007999999999999, 0.9051, 0.9075, 0.9083, 0.912, 0.914, 0.9143000000000001, 0.9220999999999999, 0.9190999999999999, 0.9237000000000001, 0.9259999999999999, 0.9285, 0.9316, 0.9340999999999999, 0.9359000000000001, 0.9388, 0.9379000000000001, 0.9304313904457892, 0.949775123174079, 0.9355739327263035, 0.9492261286024588, 0.9354833979013225, 0.9463022714477182, 0.9335179905372764, 0.9399458336368189, 0.958907647579008, 0.9584189133594903, 0.9486066975377414, 0.9430616570495803, 0.948990837524018, 0.9314625680266272, 0.9320460807683241, 0.9582069151159279, 0.933391181794839, 0.9546991338541067, 0.9314421558629615, 0.9328635033828944, 0.9434698785707233, 0.9475275816898288, 0.9503817412521566, 0.9425690244265629, 0.9328486230469732, 0.950958472145365, 0.9521343212187255, 0.9350902191316359, 0.9412741640103685, 0.9523225201830785, 0.9486322044971771, 0.9448695947510465, 0.9383243124410857, 0.9583023957534779, 0.9387632344244878, 0.937280392637831, 0.9507183375630985, 0.9556015280675281, 0.9431071479377621, 0.9339798603760907]
# lstmLoss17C = [0.2, 0.3885, 0.42100000000000004, 0.4593, 0.4792, 0.4991, 0.516, 0.5224, 0.5314, 0.5396, 0.5499, 0.5514, 0.5629, 0.5676, 0.5775, 0.5832, 0.5911, 0.5953, 0.598, 0.6037, 0.611, 0.6144, 0.6189, 0.6207, 0.6278, 0.6249, 0.6363, 0.6358, 0.6433, 0.6467, 0.6545000000000001, 0.6579, 0.6654000000000001, 0.6656, 0.6681, 0.6772, 0.6759000000000001, 0.6765000000000001, 0.6846, 0.6898000000000001, 0.6909000000000001, 0.6981999999999999, 0.7018000000000001, 0.7068000000000001, 0.7108, 0.7123999999999999, 0.72, 0.7173999999999999, 0.7191, 0.7315999999999999, 0.7339, 0.7382, 0.7454000000000001, 0.7489, 0.7452, 0.758, 0.7603, 0.7585, 0.7648999999999999, 0.7706000000000001, 0.795569555338749, 0.7759362622729803, 0.7743939390483326, 0.7794846622931638, 0.7817514326977372, 0.7799284981557151, 0.7711192676219566, 0.7734572700592973, 0.7870833974904007, 0.78733681405741, 0.7717222169963962, 0.7901297459731845, 0.7856121622274278, 0.7986886652646423, 0.7998839031887544, 0.7757684098382677, 0.77914273658911, 0.7958353191948813, 0.7777825789619807, 0.7958383993903244, 0.779486511333113, 0.7712727997295228, 0.7907542444105865, 0.7953663343164386, 0.7909304779314504, 0.7733369196620731, 0.7841517445073238, 0.7754736912810103, 0.7968583601333195, 0.7894696175543049, 0.7784368868015269, 0.7922983129944166, 0.7793197810971136, 0.7742524123528569, 0.7793268579607414, 0.7832720843633253, 0.7964464626718608, 0.7800786493880508, 0.7897748839247875, 0.7990662363257153]
# lstmLoss17D = [0.62, 0.7283, 0.782, 0.8087, 0.8283, 0.8597, 0.8606, 0.8636, 0.8645, 0.8645999999999999, 0.8673000000000001, 0.8668, 0.8682, 0.8706999999999999, 0.8734000000000001, 0.8725, 0.8733, 0.8745999999999999, 0.8737999999999999, 0.8739, 0.8773000000000001, 0.8787, 0.8805, 0.882, 0.8826999999999999, 0.8856, 0.8865999999999999, 0.8886, 0.8913, 0.8924, 0.893, 0.8952, 0.8996999999999999, 0.9011, 0.9016, 0.9066, 0.9059999999999999, 0.9086, 0.909, 0.9118, 0.9168999999999999, 0.9157, 0.9204000000000001, 0.9209999999999999, 0.9267, 0.9248000000000001, 0.9316, 0.9311, 0.9340999999999999, 0.9376000000000001, 0.9381, 0.9425, 0.9462, 0.9464, 0.9470000000000001, 0.9523, 0.9539, 0.955, 0.9595, 0.9601000000000001, 0.9743936222894722, 0.9677842902770204, 0.9789942500895288, 0.9718446372244747, 0.9631333096747298, 0.9692669644863455, 0.9654307213194767, 0.9696566553756522, 0.9758893012511809, 0.9727736464513957, 0.9615496026523049, 0.969506961596144, 0.963507172176902, 0.9685633746522548, 0.9698588668213648, 0.9728148574193328, 0.9754313786303376, 0.977077198836948, 0.9682630263926796, 0.9702290548928159, 0.9694259329966312, 0.9699072085263787, 0.9698944799274881, 0.9788535279627362, 0.9690368358055367, 0.9676774555812633, 0.9621943651371292, 0.9605404518007347, 0.9787979134663334, 0.9775507085823112, 0.9764660214286486, 0.9785128522190217, 0.9673987037397923, 0.9636016940513208, 0.9665979672829624, 0.9675146036658452, 0.9655619238256298, 0.9795432335681394, 0.9746349011039437, 0.9698359965028274]
# 创建一个新的figure  
cnnC =cnn.iloc[:60,3] 
lstmC =lstm.iloc[:60,3] 
transformerC =transformer.iloc[:60,3]
attentionlstmC =attentionlstm.iloc[:60,3] 
SADMREC =SADMRE.iloc[:60,3]
transformerlstmC = transformerlstm.iloc[:,1]+transformerlstm.iloc[:,2]
# lstmLoss17D = lstmLoss17.iloc[:,2]
fig, ax = plt.subplots()  
x=range(1,61)
ax.plot(x, cnnC,label='CNN')  
ax.plot(x, lstmC,label='LSTM')  
# ax.plot(x, e2elstmC,label='E2ELSTM')  
ax.plot(x, transformerC,label='Transformer') 
ax.plot(x, attentionlstmC,label='AttentionLSTM') 
ax.plot(x, SADMREC,label='SADMRE')  
ax.plot(x, transformerlstmC,label=' transformerlstm')  

# ax.plot(x, lstmLoss9C,label='Node9to12 Classify')  
# ax.plot(x, lstmLoss9D,label='Node9to12 Detect')  
# # ax.plot(x, lstmLoss9C5,label='Node9to125 Classify')  
# # ax.plot(x, lstmLoss9D5,label='Node9to125 Detect')  
# ax.plot(x, lstmLoss17C,label='Node17to20 Classify')  
# ax.plot(x, lstmLoss17D,label='Node17to20 Detect')  
# print(y)
# 设置y轴的刻度  
xticks = np.arange(0,66, 6) # 设置刻度的范围和间隔  
yticks = np.arange(0,3.3, 0.3) # 设置刻度的范围和间隔  
font = {'family': 'Times New Roman', 'weight': 'normal', 'size': 12}  # 修改字体样式
plt.rc('font', **font)
ax.set_yticks(yticks)  
ax.set_yticklabels(yticks)
ax.yaxis.set_major_formatter(ticker.StrMethodFormatter('{x:.2f}'))
ax.set_xticks(xticks)
ax.set_xticklabels(xticks)
legend = plt.legend()
legend.get_texts()[0].set_fontsize(12)  
legend.get_texts()[0].set_fontname('Times New Roman')  
legend.get_texts()[1].set_fontsize(12)  
legend.get_texts()[1].set_fontname('Times New Roman')  
legend.get_texts()[2].set_fontsize(12)  
legend.get_texts()[2].set_fontname('Times New Roman') 
# legend.get_texts()[3].set_fontsize(12)  
# legend.get_texts()[3].set_fontname('Times New Roman') 
# legend.get_texts()[4].set_fontsize(12)  
# legend.get_texts()[4].set_fontname('Times New Roman') 
plt.xlabel('Iteration', fontsize=12,fontname='Times New Roman')
# plt.ylabel('Loss Rate', fontsize=12,fontname='Times New Roman') 
plt.ylabel('Loss', fontsize=12,fontname='Times New Roman') 
# 显示图表  
plt.savefig('loss.pdf',dpi=600, bbox_inches='tight')
